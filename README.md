# VRベース動作評価・学習支援システム(個人差を考慮したVRベース動作学習支援システムのコアアルゴリズム)
## 概要
本リポジトリは，VR 環境を用いた **全身動作の評価および学習支援システム**の Unity プロジェクトである。  
体格差補正と視覚的フィードバックを組み合わせることで，動作の再現性および習得性の向上を目的としている。

本システムは，ダンス・スポーツ動作・リハビリテーション等における  
**模倣学習・動作評価の研究用途**を想定して開発されている。

---

主な機能は以下の2点です。
- **体格差補正アルゴリズム:** 学習者とお手本動作の提供者の体格差（身長、腕や脚の長さ）を吸収し、お手本動作を学習者の体格に合わせてリアルタイムで正規化します。 
- **一致性評価アルゴリズム:** 2つの動作の位置・回転誤差を計算し、動作の一致度を定量的にスコア化します。 

## デモ (Demonstration)
実際のシステムでは、お手本動作（緑のボーン）とユーザーの動作（白のボーン）を比較し、誤差のある部位をリアルタイムで色付けしてフィードバックします。 

<img width="1300" height="731" alt="スクリーンショット 2025-07-06 155718" src="https://github.com/user-attachments/assets/7cbe0cbf-652b-48c5-b132-2fe5e92a18bc" />
 

## 技術的ハイライト (Technical Highlights)
### 1. 体格差補正 
ユーザー間の公平な評価を実現するため、キャリブレーションで得たTポーズのデータから、身長($r_h$)、腕($r_a$)、脚($r_l$)の比率を算出します。  これらの比率を用いて、お手本動作の各トラッカー座標を線形に変換し、学習者の体格にリアルタイムでスケーリングします。

### 2. 一致性評価 
- **誤差計算:** 各ボーンの位置誤差($E_{pos}$)と回転誤差($E_{rot}$)を、それぞれユークリッド距離と四元数の角度差として計算します。 
- **閾値処理:** 微小なズレをノイズとして無視するため、計算された誤差に閾値を設定し、一定以下の誤差は0として扱います。 
- **スコアリング:** 最終的な一致度スコア`S`は、位置と回転の平均誤差に重み($w_{pos}, w_{rot}$)を付けて算出します。 
  ```csharp
  S = 1 - (w_pos * mean(E_pos) + w_rot * mean(E_rot));

## システムの特徴
- VRトラッカーを用いた全身動作の記録
- 体格差を考慮した動作再生（体格補正）
- 動作誤差に基づくリアルタイム視覚フィードバック
- リズム同期型の記録・再生機構
- 位置・回転情報に基づく客観的動作一致度評価

---

## 開発環境
- **OS**：Windows 10 / 11  
- **Unity**：Unity 2022 LTS  
- **開発言語**：C#  
- **XRランタイム**：OpenXR  

---

## 使用ハードウェア
- **HMD**：Meta Quest 3  
- **トラッカー**：HTC VIVE Ultimate Tracker  

---

## 使用プラグイン・SDK

### XR / VR 基盤
- **OpenXR**
  - クロスプラットフォームな XR ランタイム
  - HMD およびトラッカー入力の統一的な管理に使用

- **XR Interaction Toolkit (XRI)**
  - Unity 標準の XR 操作フレームワーク
  - 基本的な XR 入力・オブジェクト管理に使用

---

### VIVE / SteamVR 関連
- **VIVE OpenXR Plugin**
  - VIVE 製トラッカーを OpenXR 経由で利用するためのプラグイン
  - 全身動作計測に使用

- **SteamVR**
  - コントローラおよびトラッカーのアクション定義・バインディング管理
  - 必要な設定ファイルは `Assets/StreamingAssets` 配下に配置

---

### アバター・モデル関連
- **UniGLTF**
  - glTF / VRM モデルを Unity に読み込むためのライブラリ

- **VRM 1.0（VRM10）**
  - ヒューマノイドアバター形式
  - 動作再生および視覚フィードバック用アバターとして使用

---

### UI / テキスト表示
- **TextMesh Pro**
  - UI テキストおよび数値表示に使用
  - 自動生成される巨大な SDF フォントアセットは Git 管理対象外

---

## ディレクトリ構成（簡略）

```

Assets/
├─ MyScript/        # 動作記録・再生・評価の中核スクリプト
├─ MyMaterial/      # 視覚フィードバック用マテリアル
├─ DanceMotion/     # 動作データ関連アセット
├─ Scenes/          # 実験・デモ用シーン
├─ Settings/        # 各種設定用 ScriptableObject
├─ TextMesh Pro/    # Unity 標準テキストアセット
└─ StreamingAssets/ # SteamVR / OpenXR 用設定ファイル

```

---

## バージョン管理に関する方針
- Unity により自動生成されるファイル（Library, Temp 等）は管理対象外
- SDK やプラグインのサンプルデータは管理対象外
- 実行時に生成されるログ・記録データは管理対象外
- 巨大な自動生成 SDF フォントアセットは管理対象外
- 使用 SDK・プラグインのバージョン管理は `Packages/manifest.json` により行う

---

## 想定用途
本リポジトリは以下を目的とした **研究・実験用途**を想定している。

- 卒業研究・修士研究
- 動作学習支援に関する実験
- 国際会議・論文投稿に向けたシステム検証

商用利用を前提としたものではない。

```

